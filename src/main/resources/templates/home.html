<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script th:inline="javascript">
        window.addEventListener('load', function() {
            const openerWindow = window.opener;
            if(openerWindow) {
                openerWindow.location.href = "/";
                //openerWindow.document.location.href = "/";
                window.close();
            }

            const msg = [[${errorMessage}]];
            if(msg) {
                alert(msg);
            }
        });
    </script>
    <title>홈</title>
</head>

<body>
    <div class="container" style="max-width:720px">

        <div class="py-5 text-center">
            <h2>홈 화면</h2>
        </div>

        <!-- 로그인 사용자 -->
        <th:block sec:authorize="isAuthenticated()">

            <h5 class="mb-3">
                <span th:text="${#authentication.principal.member.nickname}">닉네임</span>
                님 로그인 하셨습니다
            </h5>


        <!--인증시 사용된 객체의 Username (ID)-->
    <!--    <div sec:authentication="name"></div>-->
        <!--인증시 사용된 객체에 대한 정보-->
    <!--    <div sec:authentication="principal.member"></div>-->


        <!--Spring Expression Language를 사용-->
    <!--    <div th:text="${#authentication.name}"></div>-->
<!--        <div th:text="${#authentication.principal.member.role}"></div>-->

            <hr class="my-4">

            <p class="row">
              <p class="col">
                <button class="w-100 btn btn-lg btn-info" type="button"
                        th:onclick="|location.href='@{/posts}'|">
                  게시판
                </button>
              </p>
            </p>

            <div class="row">
              <div class="col">
                <button class="w-100 btn btn-primary btn-lg" type="button"
                        th:onclick="|location.href='@{/member/info}'|">
                  마이페이지
                </button>
              </div>
              <div class="col">
                <form th:action="@{/logout}" method="post">
                  <button class="w-100 btn btn-dark btn-lg" type="submit">
                    로그아웃
                  </button>
                </form>
              </div>
            </div>
        </th:block>

        <!-- 비로그인 사용자 -->
        <th:block sec:authorize="isAnonymous()">

            <p class="row">
                <p class="col">
                  <button class="w-100 btn btn-lg btn-info" type="button"
                          th:onclick="|location.href='@{/posts}'|">
                    게시판
                  </button>
                </p>
            </p>

            <div class="row">
              <div class="col">
                <button class="w-100 btn btn-secondary btn-lg" type="button"
                        th:onclick="|location.href='@{/signup}'|">
                  회원 가입
                </button>
              </div>
              <div class="col">
                <button class="w-100 btn btn-dark btn-lg"
                        th:onclick="|location.href='@{/login}'|" type="button">
                  로그인
                </button>
              </div>
            </div>
        </th:block>

        <hr class="my-4">

        <div class="mt-5">
            <p class="text-center">
                <small class="text-muted">Copyright © www.yoursite.com All rights reserved.</small>
            </p>
        </div>
    </div> <!-- /container -->

</body>
</html>